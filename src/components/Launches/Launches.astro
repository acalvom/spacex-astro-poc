---
import { type Doc, type SpaceXAPIResponse } from '@interfaces/api'

const response = await fetch('https://api.spacexdata.com/v4/launches/query', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    options: {
      limit: 10,
      sort: { date_unix: 'asc' }
    }
  })
})
const data: SpaceXAPIResponse = await response.json()
const lastLaunches: Doc[] = data.docs
---

<section class="w-full p-4 mx-auto">
  <h3 class="text-3xl lg:text-4xl tracking-tight text-white text-center font-bold mb-4">
    Ãšltimos lanzamientos
  </h3>
  <div class="flex flex-wrap justify-evenly mx-4">
    {
      lastLaunches.map((launch) => (
        <article class="mx-1 my-4 max-w-sm md:w-1/2 lg:w-1/3">
          <div class="flex flex-col p-8 border rounded-md shadow-md shadow-gray-400 duration-300 hover:-translate-y-1">
            <img src={launch.links.patch.small} alt={launch.name} />

            <h4 class="text-2xl my-2 font-semibold leading-relaxed text-gray-400">
              #{launch.flight_number} {launch.name}
            </h4>
            <span
              class:list={[
                'w-fit text-xs font-medium my-2 px-2.5 py-0.5 rounded',
                {
                  'bg-green-100 text-green-800': launch.success,
                  'bg-red-100 text-red-800': !launch.success
                }
              ]}
            >
              {launch.success ? 'Success' : 'Fail'}
            </span>
            <p class="my-1 font-light leading-6 line-clamp-2 text-gray-300">
              {launch.details ? launch.details : 'No detailes provided related to this launch'}
            </p>
          </div>
        </article>
      ))
    }
  </div>
</section>
